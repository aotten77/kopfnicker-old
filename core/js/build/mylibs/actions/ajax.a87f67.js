define(["jquery","_super","rAF"],function($,_super){"use strict";var ajax=$.extend({},_super,{init:function(a,b){return this.options=$.extend({},this.options,a),this.name=this.options.pluginName,this.pos=this.options.pos,this.jmname=this.options.jmname,this.$elem=$(b),_super.config.call(this),this.onInitExec(),this},onInitExec:function(){if(this.loader=this.is("loader"),""!==this.loader)switch(this.loader){case"sticky":this.$ani=$('<div class="loader-sticky"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div> ');break;case"spinner":this.$ani=$('<div class="loading-container"><div class="loading"></div></div>');break;case"none":break;default:this.$ani=$('<div class="loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div> ')}else this.$ani=$('<div class="loading-container"><div class="loading"></div></div>');""!==this.is("additionalloadertarget")&&(this.$additionalloader=$('<div class="loading-container"><div class="loading"></div></div>'))},options:{},render:function(){eval(this.conditionSource)?(window.cancelAnimationFrame(this.rAFRender),this._exec()):this.rAFRender=window.requestAnimationFrame(this.render.bind(this))},_getData:function(){return-1!==this.is("data").indexOf("this.")?eval(this.is("data")):this.is("data").match(/^\$\$(.*)/)?(window.jmGO=window.jmGO||{},window.jmGO[this.is("data")]=window.jmGO[this.is("data")]||{},"select"===this.$elem[0].tagName.toLowerCase()&&(window.jmGO[this.is("data")][this.$elem.attr("name")]=this.$elem.val()),this._convertObjToQueryString(window.jmGO[this.is("data")])):this.is("data")||""},_getUrl:function(){return""!==this.is("url")?this.is("url"):"undefined"!==$.type(this.$elem.attr("href"))?this.$elem.attr("href"):void 0},_convertObjToQueryString:function(a){var b="";return $.each(a,function(a,c){""!==c&&(b=b+(""!==b?"&":"")+a+"="+c)}),b},_exec:function(){var a=this;""!==this.is("additionalloadertarget")&&$(this.is("additionalloadertarget")).append(this.$additionalloader),this.$destination=this.subObj_$destination||$(this.is("relatedTo")),this.injection=this.subObj_injection||this.is("inject"),$.ajax({type:""!==a.is("method")&&a.is("method","post")?"POST":"GET",url:a._getUrl(),data:a._getData(),beforeSend:function(){a._beforeSend(a.$destination)}}).done(function(b){a.data=b.match(/<(.*)[^>]*>/)?$(b):b,window.requestAnimationFrame(a._injectAfterFrame.bind(a))}).always(function(){}).fail(function(){a.$ani.remove(),""!==a.is("additionalloadertarget")&&a.$additionalloader.remove()})},_beforeSend:function(a){"undefined"!==$.type(this.$ani)&&(this.$ani.css({top:jmHF.getClientHeight()/2}),a[this.injection](this.$ani)),""!==this.is("scrollTo")&&this._scrollTo()},_injectAfterFrame:function(){var a=this;"undefined"!==$.type(this.$ani)&&this.$ani.remove(),""!==this.is("loadertarget")&&this.$loadertargetani.remove(),"html"===this.injection&&this.$destination.empty(),this.$destination[this.injection](this.data),setTimeout(function(){"string"!==$.type(a.data)&&a.data.requirementsForJmPlugins().triggerSelfexecObj().picturefill()},200),"remove"===this.is("afterexec")&&this.$elem.remove(),this.ajaxCompleteCallback()},ajaxCompleteCallback:function(){}});return $.plugin("actions.ajax",ajax),ajax});